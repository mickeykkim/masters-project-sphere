{% extends "base.html" %}

{% block title %}
<title>Bristol Sphere PD Sensors - Camera Data</title>
{% endblock %}

{% load static %}

{% block style %}
<link rel="stylesheet" href="{% static 'css/cameradata_detail.css' %}">
{% endblock %}

{% block content %}
<h1>Patient: {{ cameradata.patient }} </h1>
<p>Session Time: <em>{{ cameradata.time }}</em> | Note: <em>{{ cameradata.note }}</em></p>
<hr>
<!-- VideoFrame Object -->
<script src="{% static 'js/VideoFrame.min.js' %}"></script>

<div class="videoFrame">
  <video name="{{ cameradata.patient }} - {{ cameradata.time }}" align="left" height="50%" width="100%" id="video"
    src="{{ media_url }}{{ cameradata.filename }}" type="video/mp4" playsinline></video>

  <div id="controls" class="videoControls">
    <div class="playControls">
      <button id="play-pause" class="controlButtonL">Play</button>
      <input type="range" id="seek-bar" class="seekBar" style="width:46%;" min="0" value="0" step="1">
      <span id="video-time" class="timestamp">00:00</span><span class="timestamp">/</span><span id="video-duration"
        class="timestamp">00:00</span>
      <button id="mute" class="controlButtonL">Mute</button>
      <input type="range" id="volume-bar" class="volumeBar" style="width:9%;" min="0" max="1" step="0.1"
        value="1"></input>
    </div>
    <div class="seekControls">
      <input type="text" id="rewind-value" class="rewindTextValue" value=0 data-toggle="tooltip" data-placement="bottom" title="Frame to jump back to">
      <button id="rewind-video" class="controlButtonM" data-toggle="tooltip" data-placement="bottom" title="Jump back to frame"><i class="material-icons">skip_previous</i></button>
      <span class="vert-divider">|</span>
      <span class="selectBox">
        <select id="backward-increment" class="dropDown" data-toggle="tooltip" data-placement="bottom" title="# of frames to step back">
          <option value="1">1</option>
          <option value="2">5</option>
          <option value="3">10</option>
          <option value="4">25</option>
          <option value="5">50</option>
        </select>
      </span>
      <button id="seek-backward" class="controlButtonM" data-toggle="tooltip" data-placement="bottom" title="Step backwards"><i class="material-icons">fast_rewind</i></button>
      <span class="vert-divider">|</span>
      <span class="selectBox">
        <select id="forward-increment" class="dropDown" data-toggle="tooltip" data-placement="bottom" title="# of frames to step forward">
          <option value="1">1</option>
          <option value="2">5</option>
          <option value="3">10</option>
          <option value="4">25</option>
          <option value="5">50</option>
        </select>
      </span>
      <button id="seek-forward" class="controlButtonM" data-toggle="tooltip" data-placement="bottom" title="Step forwards"><i class="material-icons">fast_forward</i></button>
      <span class="vert-divider">|</span>
      <span class="selectBox annotationDropDown">
        {{ form.annotation }}
        {% comment %}
        <select id="annotation-list" class="annotationDropDown">
          <option value="a1">prone sup</option>
          <option value="a2">b</option>
          <option value="a3">c</option>
          <option value="a4">d</option>
          <option value="a5">e</option>
        </select>
        {% endcomment %}
      </span>
      <input type="text" name="other-annotation" class="otherText" value="(other)" disabled=true data-toggle="tooltip" data-placement="bottom" title="Other annotation">
      <button id="annotate" class="controlButtonM" data-toggle="tooltip" data-placement="bottom" title="Save annotation"><i class="material-icons">create</i></button>
      <span class="vert-divider">|</span>
      <button id="help" class="controlButtonM" data-toggle="tooltip" data-placement="bottom" title="Display shortcut keys"><i class="material-icons">live_help</i></button>
    </div>
  </div>
</div>

<div class="frameDetails">
  <span class="frameStatusText">Framerate:</span>
  <span class="selectBox">
    <select id="framerate-list" class="fpsDropDown">
      <option value="1">24</option>
      <option value="2">25</option>
      <option value="3" selected=true>29.97</option>
      <option value="4">30</option>
      <option value="5">60</option>
    </select>
  </span>
  <span class="vert-divider">|</span>
  <span class="frameStatusText">
    Frame: <span id="current-frame" class="timestamp">0</span>
    <button id="copy-frame" class="controlButtonS" data-toggle="tooltip" data-placement="bottom" title="Copy frame to clipboard"><i class="material-icons">assignment_returned</i></button>
    <span class="vert-divider">|</span>
    Time (hh:mm:ss:ff): <span id="current-time" class="timestamp">00:00:00:00</span>
    <button id="copy-time" class="controlButtonS" data-toggle="tooltip" data-placement="bottom" title="Copy time to clipboard"><i class="material-icons">assignment_returned</i></button>
  </span>
</div>
<hr>

<!-- Camera Annotation List -->
<div style="margin-left:20px;margin-top:20px">
  <h4>Camera Annotations <button id="export_all" class="controlButtonS" data-toggle="tooltip" data-placement="bottom" title="Download annotations"><i class="material-icons">save_alt</i></button>
  </h4>
  <ul>
    {% for annotation in cameradata.cameraannotation_set.all %}
    <li><a href="{% url 'cameraannotation-detail' cameradata.id annotation.id %}">
        {{annotation.timestamp}} - {{annotation.get_annotation_display}}</a>
      <button id="annotation_{{ annotation.id }}" class="controlButtonXS"><i
          class="material-icons" data-toggle="tooltip" data-placement="bottom" title="Jump to annotation">skip_previous</i></button>
    </li>
    {% endfor %}
  </ul>
</div>
{% endblock %}

{% block javascript %}
<script type="text/javascript" src="{% static 'js/cameradata_detail.js' %}"></script>
{% endblock %}

{% block jquery %}
$('[data-toggle="tooltip"]').tooltip(); 
{% endblock %}